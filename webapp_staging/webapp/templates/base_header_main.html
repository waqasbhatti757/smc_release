{% load custom_tags %}
{% load static %}
<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}SMC Tracker{% endblock %}</title>

    <!-- Core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />

    <link rel="stylesheet" href="{% static 'plugins/bootstrap/css/bootstrap.min.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'js/multiselect/jquery.multiselect.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'plugins/bootstrap/datepicker/css/bootstrap-datepicker.css' %}"
          type="text/css"/>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/litepicker/dist/css/litepicker.css">
    <link href="https://cdn.jsdelivr.net/npm/tom-select/dist/css/tom-select.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{% static 'plugins/bootstrap/datetimepicker/css/bootstrap-datetimepicker.css' %}"
          type="text/css"/>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="{% static 'js/html5shiv.min.js' %}"></script>
    <script src="{% static 'js/respond.min.js' %}"></script>
    <style>
        [x-cloak] { display: none !important; }
    </style>
    <style>
    /* Compact Tom Select styling */
    .ts-control {
      min-height: 28px;           /* smaller height */
      font-size: 12px;            /* smaller font */
      border-radius: 6px;         /* rounded corners */
      padding: 2px 6px;           /* compact padding */
      align-items: center;        /* center text vertically */
    }
    .ts-dropdown {
      font-size: 12px;            /* smaller font in dropdown */
      max-height: 120px;          /* max height with scroll */
      overflow-y: auto;
      border-radius: 6px;
    }
    .ts-item {
      font-size: 11px;            /* smaller items */
      line-height: 18px;          /* vertically centered */
      border-radius: 4px;
    }
  </style>
<style>
    /* Global font-size override for consistency */
    .choices__inner,
    .choices__list--dropdown,
    .choices__item {
        font-size: 12px !important;
    }

    #UCMain .choices,
    #DistrictMain .choices,
    #DistrictMainExcel .choices,
    #ZDDistrictMain .choices,
    #ZDDistrictMainExcel .choices,
    #ProvinceMain .choices,
    #DivisionMain .choices,
    #ProvinceMainExcel .choices,
    #DivisionMainExcel .choices {
        overflow: visible !important;
    }

    #UCMain .choices__inner,
    #DistrictMain .choices__inner,
    #DistrictMainExcel .choices__inner,
    #ZDDistrictMain .choices__inner,
    #ZDDistrictMainExcel .choices__inner,
    #ProvinceMain .choices__inner,
    #DivisionMain .choices__inner,
    #ProvinceMainExcel .choices__inner,
    #DivisionMainExcel .choices__inner {
        min-height: 30px;
        max-height: 41px; /* limit height */
        overflow-y: auto; /* scroll if too many items */
        border-radius: 9px;
        font-size: 6px;
    }

    #UCMain .choices__list--multiple .choices__item,
    #DistrictMain .choices__list--multiple .choices__item,
    #DistrictMainExcel .choices__list--multiple .choices__item,
    #ZDDistrictMain .choices__list--multiple .choices__item,
    #ZDDistrictMainExcel .choices__list--multiple .choices__item,
    #ProvinceMain .choices__list--multiple .choices__item,
    #DivisionMain .choices__list--multiple .choices__item,
    #ProvinceMainExcel .choices__list--multiple .choices__item,
    #DivisionMainExcel .choices__list--multiple .choices__item {
        font-size: 12px;
        padding: 2px 6px;
        border-radius: 10px;
    }

    #UCMain .choices__list--dropdown,
    #DistrictMain .choices__list--dropdown,
    #DistrictMainExcel .choices__list--dropdown,
    #ZDDistrictMain .choices__list--dropdown,
    #ZDDistrictMainExcel .choices__list--dropdown,
    #ProvinceMain .choices__list--dropdown,
    #DivisionMain .choices__list--dropdown,
    #ProvinceMainExcel .choices__list--dropdown,
    #DivisionMainExcel .choices__list--dropdown {
        overflow-y: auto;
        overflow-x: hidden;
        font-size: 12px;
        border-radius: 10px;
        z-index: 9999; /* ensure visibility above other elements */
    }

    #UCMain .choices__list--dropdown .choices__item,
    #DistrictMain .choices__list--dropdown .choices__item,
    #DistrictMainExcel .choices__list--dropdown .choices__item,
    #ZDDistrictMain .choices__list--dropdown .choices__item,
    #ZDDistrictMainExcel .choices__list--dropdown .choices__item,
    #ProvinceMain .choices__list--dropdown .choices__item,
    #DivisionMain .choices__list--dropdown .choices__item,
    #ProvinceMainExcel .choices__list--dropdown .choices__item,
    #DivisionMainExcel .choices__list--dropdown .choices__item {
        padding: 5px 8px;
        word-break: break-word;
    }

    #UCMain .choices__input,
    #DistrictMain .choices__input,
    #DistrictMainExcel .choices__input,
    #ZDDistrictMain .choices__input,
    #ZDDistrictMainExcel .choices__input,
    #ProvinceMain .choices__input,
    #DivisionMain .choices__input,
    #ProvinceMainExcel .choices__input,
    #DivisionMainExcel .choices__input {
        font-size: 12px;
        padding: 3px 5px;
    }
</style>

    <style media="screen">
        input {
            text-transform: uppercase;
        }
        .dataTables_paginate .paginate_button:not(.previous):not(.next) {
            display: none !important;
          }
    </style>
    <style>
        body {
            margin: 2rem;
        }

        .user-info {
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 2rem;
            background-color: #f9f9f9;
        }

        .logout-btn {
            background-color: #e63946;
            color: white;
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
        }

        .logout-btn:hover {
            background-color: #c9303e;
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>

<body>
<!--{% if user_info %}-->
<!--<p>Logged in as: {{ user_info }}</p>-->
<!--{% else %}-->
<!--<p>No user info in session.</p>-->
<!--{% endif %}-->

<header class="main-header">
    <nav class="navbar">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->


            <!-- Wrap this whole block in a container like a navbar, aligned right -->
            <!-- Navbar -->
            <nav class="relative z-50 w-full bg-white dark:bg-gray-900 shadow px-6 py-3 flex items-center justify-between font-sans">
                <!-- Left side (App Logo or Name) -->
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="{% url 'dashboard:user_dashboard' %}">
                    <span class="icon"><i class="fa fa-bullseye" aria-hidden="true"></i></span>
                    SMC/ZD Tracker
                    <small class="{% if request.build_absolute_uri == 'https://dsc.eoc.gov.pk/beta/' %}{{ '' }}{% else %}hide{% endif %}"
                           style="color:red;">
                        BETA
                    </small>
                </a>
                <img src="{% static 'images/polio.png' %}" alt="Polio" style="font-size: 8px; width: 220px; height: auto;" />

                <!-- Right side (User Dropdown) -->
                <div class="relative" x-data="{ open: false }">
                    <!-- Trigger -->

                    <button @click="open = !open"
                            class="flex items-center gap-2 text-3xl font-semibold text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-contact-round-icon lucide-contact-round"><path d="M16 2v2"/><path d="M17.915 22a6 6 0 0 0-12 0"/><path d="M8 2v2"/><circle cx="12" cy="12" r="4"/><rect x="3" y="4" width="18" height="18" rx="2"/></svg>
                        <span class="bg-gradient-to-r from-green-500 to-green-600 text-white px-2 py-1 rounded shadow-md text-sm">
                            {{ user_info.username }}
                        </span>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>

                    <!-- Dropdown -->
                    <div x-show="open"
                         @click.away="open = false"
                         x-transition x-cloak
                         class="p-2 absolute right-0 mt-2 w-72 rounded-lg bg-white shadow-xl ring-1 ring-black ring-opacity-10 dark:bg-gray-800 z-50">

                        <!-- User Info -->
                        <div class="px-2 py-2 border border-gray-200 dark:border-gray-700 rounded-lg">
                            <h6 class="text-[10px] text-gray-500 py-2">You are signed in from:</h6>
<!--                            <p class="text-xl font-semibold py-1">-->
<!--                                <span class="inline-block bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-1 py-1 rounded">-->
<!--                                    {{ user_info.username }}-->
<!--                                </span>-->
<!--                            </p>-->
                            <p class="text-base text-gray-500 dark:text-gray-400">
                                <span class="inline-block bg-yellow-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-1 py-1 rounded">
                                    {{ user_info.email }}
                                </span>
                            </p>
                        </div>


                        <!-- Menu Links -->
                        <!-- Dropdown Menu -->
                        <ul class="flex flex-col gap-1 border-b border-gray-200 pt-4 pb-3 dark:border-gray-800">

                            <!-- Dashboard -->
<!--                            <li>-->
<!--                                <a href="#"-->
<!--                                   class="group flex items-center gap-3 rounded-lg px-3 py-2 text-[15px] font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-200">-->
<!--                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gauge-icon lucide-gauge"><path d="m12 14 4-4"/><path d="M3.34 19a10 10 0 1 1 17.32 0"/></svg>-->
<!--                                    <span>Dashboard</span>-->
<!--                                </a>-->
<!--                            </li>-->

                            <!-- Admin-only items -->
                            {% if user_info.usertype == 1 or user_info.is_province_admin == 1 or user_info.is_district_admin == 1  or user_info.is_division_admin == 1  or user_info.is_tehsil_admin == 1 %}
                            <li>
                                <a href="{% url 'usermanagement:create_user' %}"
                                   class="flex items-center gap-3 rounded-lg px-3 py-2 text-[15px] font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-badge-plus-icon lucide-badge-plus"><path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"/><line x1="12" x2="12" y1="8" y2="16"/><line x1="8" x2="16" y1="12" y2="12"/></svg>
                                    <span>Create User</span>
                                </a>
                            </li>

                            <li>
                                <a href="{% url 'usermanagement:manage_user' %}"
                                   class="flex items-center gap-3 rounded-lg px-3 py-2 text-[15px] font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-gallery-vertical-end-icon lucide-gallery-vertical-end"><path d="M7 2h10"/><path d="M5 6h14"/><rect width="18" height="12" x="3" y="10" rx="2"/></svg>
                                    <span>Manage Users</span>
                                </a>
                            </li>
                            {% endif %}

                            <!-- Update Profile -->
                            <li>
                                <a href="{% url 'usermanagement:update_settings' %}"
                                   class="flex items-center gap-3 rounded-lg px-3 py-2 text-[15px] font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-round-pen-icon lucide-user-round-pen"><path d="M2 21a8 8 0 0 1 10.821-7.487"/><path d="M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"/><circle cx="10" cy="8" r="5"/></svg>
                                    <span>Update Settings</span>
                                </a>
                            </li>
                        </ul>

                        <!-- Sign Out -->
                        <a href="{% url 'accounts:logout' %}"
                           class="group w-full flex items-center gap-3 rounded-lg px-3 py-2 text-[15px] font-medium text-gray-700 hover:bg-red-50 hover:text-red-600 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-red-400 transition">
                            <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-log-out-icon lucide-log-out">
                                <path d="m16 17 5-5-5-5"/>
                                <path d="M21 12H9"/>
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            </svg>
                            <span>Sign Out</span>
                        </a>


                    </div>
                </div>
            </nav>

        </div><!-- /.container-fluid -->
    </nav>
</header>
<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <ul class="nav content-tabs nav-tabs">

                    {% if user_info.usertype|in_list:"1,2,3,4,5,6,7,8,9,11,12" %}
                    <li role="presentation"
                        class="dropdown {% if request.resolver_match.app_name == 'dashboard' %}active{% endif %}">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false"><i class="fa fa-dashboard"></i> Dashboard <i
                                class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            {% if user_info.usertype|in_list:"1,2,3,4,5,6,7,8,9,11,12" %}
                            {% if user_info.usertype|in_list:"1, 2, 3, 4, 6, 11, 12" %}

                            <li class="{% if request.resolver_match.url_name == 'index' and request.resolver_match.app_name == 'dashboard' %}active{% endif %}">
                                <a href="{% url 'dashboard:user_dashboard' %}">Dashboard</a>
                            </li>

                            {% endif %}
                            {% endif %}

                            {% if user_info.usertype|in_list:"5" %}

                            <li class="{% if request.resolver_match.app_name == 'dashboard' and request.resolver_match.url_name == 'uc_wise_dashboard' %}active{% endif %}">
                                <a href="#">Dashboard</a>
                            </li>
                            {% endif %}


                            {% if user_info.usertype|in_list:"1" %}

                            <li class="{% if request.resolver_match.app_name == 'dashboard' and request.resolver_match.url_name == 'teamtracker' %}active{% endif %}">
                                <a href="#">Team Tracker</a>
                            </li>


                            <li class="{% if request.resolver_match.app_name == 'tracker' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="#" target="_blank">Live Tracker</a>
                            </li>
                            {% else %}

                            {% endif %}

                        </ul>
                    </li>
                    <li role="presentation" class="dropdown
							{% if request.resolver_match.app_name == 'form2b' and request.resolver_match.url_name not in 'ncbvuploadfile cbvuploadfile' %}
								active
							{% endif %}
						">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false"><i class="fa fa-plus-square"></i> Add Campaign Data <i
                                class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            {% if user_info.usertype|in_list:"1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12" %}
                            {% if user_info.usertype == 1 or user_info.is_province_admin == 1 or user_info.is_district_admin == 1 or user_info.is_division_admin == 1 or user_info.is_tehsil_admin == 1 %}
                            <li class="{% if request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="{% url 'campaign_data:add_campaign_data' %}">Add SMC Form</a>
                            </li>

                            <li class="{% if request.resolver_match.url_name == 'editsheet' %}active{% endif %}">
                                <a href="{% url 'campaign_data:edit_campaign_data' %}">Edit SMC Form</a>
                            </li>
                            <li class="{% if request.resolver_match.url_name == 'sheetfollowup' %}active{% endif %}
                       {% if smc_recorded == 0 %} d-none hide{% endif %}">
                                <a href="{% url 'campaign_data:smc_follow_up' %}">SMC Form Follow Up</a>
                            </li>
                            <li class="{% if request.resolver_match.url_name == 'listing' %}active{% endif %}">
                                <a href="{% url 'campaign_data:read_campaign_data' %}">SMC Form Lists</a>
                            </li>
                            <li class="{% if request.resolver_match.url_name == 'form2b' %}active{% endif %}">
                                <a href="{% url 'campaign_data:report_new_pmc' %}">Report New PMC</a>
                            </li>
                            {% endif %}
                            {% endif %}
                            {% if user_info.usertype|in_list:"1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12" %}
                            <li class="{% if request.resolver_match.url_name == 'form2b' %}active{% endif %}">
                                <a href="{% url 'campaign_data:reports_smc' %}">SMC Linelist Report</a>
                            </li>
                            {% endif %}


                            {% if user_info.usertype|in_list:"5" %}
                            <li class="{% if request.resolver_match.url_name == 'form2b' %}active{% endif %}">
                                <a href="#">SMC Linelist Report</a>
                            </li>

                            {% endif %}
                        </ul>
                    </li>


                    <li role="presentation" class="dropdown
						{% if request.resolver_match.app_name == 'zerodose' and request.resolver_match.url_name != 'ncbvuploadfile' and request.resolver_match.url_name != 'cbvuploadfile' %}
							active
						{% endif %}">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false"><i class="fa fa-plus-square"></i> Zero Dose Data <i
                                class="fa fa-caret-down"></i></a>

                        <ul class="dropdown-menu">
                            {% if user_info.usertype|in_list:"1, 2, 3, 4, 6, 11, 12" %}
                            <li class="{% if request.resolver_match.app_name == 'zero_dashboard' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="#">Dashboard</a>
                            </li>
                            {% endif %}

                            {% if user_info.usertype|in_list:"5" %}
                            <li class="{% if request.resolver_match.app_name == 'zero_dashboard' and request.resolver_match.url_name == 'uc_wise_dashboard' %}active{% endif %}">
                                <a href="#">Dashboard</a>
                            </li>
                            {% endif %}

                            {% if user_info.usertype|in_list:"1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12" %}
                            <li class="{% if request.resolver_match.app_name == 'zerodose' and request.resolver_match.url_name == 'listing' %}active{% endif %}">
                                <a href="#">Zero Dose Lists</a>
                            </li>
                            {% endif %}
                        </ul>
                    </li>

                    <li role="presentation"
                        class="dropdown {% if request.resolver_match.app_name == 'campaign' %}active{% endif %}">
                        {% if user_info.usertype|in_list:"1" %}
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false"><i class="fa fa-file-text"></i> Campaigns <i
                                class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            {% if user_info.usertype|in_list:"1" %}
                            <li class="{% if request.resolver_match.app_name == 'campaign' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="{% url 'campaign_planning:planning' %}">All Campaigns</a>
                            </li>
                            {% endif %}
                            <li class="{% if request.resolver_match.app_name == 'campaign' and request.resolver_match.url_name == 'plan' %}active{% endif %}">
                                <a href="{% url 'campaign_planning:campaign_planning' %}">Planning</a>
                            </li>

                        </ul>
                        {% endif %}
                    </li>

                    {% if user_info.usertype != 5 %}
                    <li role="presentation"
                        class="dropdown {% if request.resolver_match.app_name == 'reports' and request.resolver_match.url_name != 'pmcreports' %}active{% endif %}">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false"><i class="fa fa-book"></i> Reports <i class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            <li class="{% if request.resolver_match.app_name == 'reports' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="#">SMC Report</a>
                            </li>
                            <li class="{% if request.resolver_match.app_name == 'zd_reports' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="#">ZD Report</a>
                            </li>
                        </ul>
                    </li>
                    {% endif %}

                    <!-- <li role="presentation"><a href="#">PMC Dashboard</a></li> -->
                    {% if user_info.usertype|in_list:"1" or user_info.is_pmc == 1 %}

                    <li role="presentation"
                        class="dropdown {% if request.resolver_match.app_name == 'pmc' or request.resolver_match.app_name == 'reports' and request.resolver_match.url_name == 'pmcreports' %}active{% endif %}">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false"><i class="fa fa-file-text"></i> PMC <i
                                class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            <li class="{% if request.resolver_match.app_name == 'pmc' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="#">Dashboard</a>
                            </li>
                            {% if user_info.usertype|in_list:"1" %}
                            <li class="{% if request.resolver_match.app_name == 'pmc' and request.resolver_match.url_name == 'auto' %}active{% endif %}">
                                <a href="#">Auto PMC</a>
                            </li>
                            {% endif %}
                            <li class="{% if request.resolver_match.app_name == 'pmc' and request.resolver_match.url_name == 'manual' %}active{% endif %}">
                                <a href="#">Manual PMC</a>
                            </li>
                            <li class="{% if request.resolver_match.app_name == 'reports' and request.resolver_match.url_name == 'pmcreports' %}active{% endif %}">
                                <a href="#">PMC Reports</a>
                            </li>
                            {% if user_info.usertype|in_list:"1" %}
                            <li class="{% if request.resolver_match.app_name == 'pmc' and request.resolver_match.url_name == 'linked' %}active{% endif %}">
                                <a href="#">PMC Linked</a>
                            </li>
                            {% endif %}
                            <li class="{% if request.resolver_match.app_name == 'pmc' and request.resolver_match.url_name == 'remaining' %}active{% endif %}">
                                <a href="#">PMC Corrections</a>
                            </li>
                        </ul>
                    </li>
                    {% endif %}

                    {% if user_info.usertype == 1 %}
                    <li role="presentation"
                        class="dropdown pull-right {% if request.resolver_match.app_name == 'administration' %}active{% endif %}">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                           aria-expanded="false">Administration <i class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            <li class="{% if request.resolver_match.app_name == 'administration' and request.resolver_match.url_name == 'index' %}active{% endif %}">
                                <a href="#">Generate Keys</a>
                            </li>

                        </ul>
                    </li>
                    {% endif %}
                    {% endif %}
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="inner-content">
                    <div id="min-preloader">
                        <div id="min-status"></div>
                    </div>
                    {% block content %}{% endblock %}
                </div>
            </div>
        </div>
    </div>
</section>
{% if flag == 1 %}
<style>
  /* Modal overlay */
  #customModalOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1050;
  }

  /* Modal box */
  #customModal {
    background-color: #fff;
    padding: 2rem;
    border-radius: 10px;
    width: 100%;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    animation: fadeIn 0.3s ease-in-out;
  }

  /* Prevent background interaction */
  body.modal-active {
    overflow: hidden;
  }

  /* Animation */
  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }

  /* Button styling (optional) */
  #customModal button[type="submit"] {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 4px;
    cursor: pointer;
  }

  #customModal button[type="submit"]:hover {
    background-color: #0056b3;
  }

</style>

<!-- Modal HTML -->
<div id="customModalOverlay">
  <div id="customModal" class="space-y-12 border-t border-gray-100 p-5 sm:p-12 dark:border-gray-800">

    <h2>Please Complete Your Profile</h2>
    <form id="update_user_profile" method="POST" action="{% url 'usermanagement:update_user_profile' %}">
      {% csrf_token %}
      {% include "partial_template/user_form.html" %}
      <button type="submit" class="mt-3">Submit</button>
    </form>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.body.classList.add("modal-active");

    // Optional: disable Escape and Back navigation
    window.onkeydown = function (e) {
      if (e.key === 'Escape') {
        e.preventDefault();
        return false;
      }
    };
    window.onpopstate = function () {
      history.pushState(null, null, location.href);
    };
    history.pushState(null, null, location.href);
  });
</script>

{% endif %}




<!-- Core JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

<!--<script src="{% static 'js/jquery-1.11.2.min.js' %}"></script>-->
<script src="{% static 'plugins/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/modernizr.js' %}"></script>
<script src="{% static 'js/app.js' %}"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

{% block extra_js %}{% endblock %}
</body>

</html>
